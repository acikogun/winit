version: 2.1
orbs:
  shellcheck: circleci/shellcheck@1.3.15

jobs:
  "debian-stretch":
    docker:
      - image: debian:stretch
    steps:
      - checkout
      - run: ./winit -a
      - run: bash test/test_all.sh

  "debian-buster":
    docker:
      - image: debian:buster
    steps:
      - checkout
      - run: ./winit -a
      - run: bash test/test_all.sh

  "ubuntu-xenial":
    docker:
      - image: ubuntu:xenial
    steps:
      - checkout
      - run: ./winit -a
      - run: bash test/test_all.sh

  "ubuntu-bionic":
    docker:
      - image: ubuntu:bionic
    steps:
      - checkout
      - run: ./winit -a
      - run: bash test/test_all.sh

  "centos-7":
    docker:
      - image: centos:7
    steps:
      - checkout
      - run: ./winit -a
      - run: bash test/test_all.sh

  "centos-8":
    docker:
      - image: centos:8
    steps:
      - run: ./winit -a
      - run: bash test/test_all.sh

workflows:
  shellcheck:
    jobs:
      - shellcheck/check
  build:
    jobs:
      - "debian-stretch"
      - "debian-buster"
      - "ubuntu-xenial"
      - "ubuntu-bionic"
      - "centos-7"
      - "centos-8"
